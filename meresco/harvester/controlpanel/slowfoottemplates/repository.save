<%
from meresco.harvester.controlpanel.tools import getDomainId
repository = asform(input)
domainId = getDomainId(req.uri)
fileName = args.name
target(filepath(fileName))
groupId = args.referrerGroup
%><?xml version="1.0"?>
<repository>
  <id><% escape_xml(repository.id) %></id>
  <repositoryGroupId><% escape_xml(repository.repositoryGroupId) %></repositoryGroupId>
  <use><% escape_xml(repository.use) %></use>
  <complete><% escape_xml(repository.complete) %></complete>
  <action><% escape_xml(repository.repositoryAction) %></action>
  <baseurl><% escape_xml(repository.baseurl) %></baseurl>
  <set><% escape_xml(repository.set) %></set>
  <collection><% escape_xml(repository.collection) %></collection>
  <targetId><% escape_xml(repository.targetId) %></targetId>
  <metadataPrefix><% escape_xml(repository.metadataPrefix) %></metadataPrefix>
  <mappingId><% escape_xml(repository.mappingId) %></mappingId>
<%
if repository.maximumIgnore:
%>
  <maximumIgnore><% escape_xml(repository.maximumIgnore) %></maximumIgnore>
<%
for i in range(1,1+int(repository.numberOfTimeslots)):
	if repository.get('deleteTimeslot_' + str(i)+".x", None) == None:
		#
%>   <shopclosed><%= '%s:%s:%s:00-%s:%s:%s:00' % (repository.getfirst('shopclosedWeek_'+str(i)),
	repository.getfirst('shopclosedWeekDay_'+str(i)),
	repository.getfirst('shopclosedBegin_'+str(i)),
	repository.getfirst('shopclosedWeek_'+str(i)),
	repository.getfirst('shopclosedWeekDay_'+str(i)),
	repository.getfirst('shopclosedEnd_'+str(i))) %></shopclosed>
<%
	#
#
if repository.get('addTimeslot', None) != None:
  #
%>
  <shopclosed><%= '%s:%s:%s:00-%s:%s:%s:00' % (repository.getfirst('shopclosedWeek_0'),
	repository.getfirst('shopclosedWeekDay_0'),
	repository.getfirst('shopclosedBegin_0'),
	repository.getfirst('shopclosedWeek_0'),
	repository.getfirst('shopclosedWeekDay_0'),
	repository.getfirst('shopclosedEnd_0')) %>
  </shopclosed>
<%
#
%>

<%
#
if repository.get('deleteTimeslot', None) != None:
  #
%>
  <shopclosed><%= '%s:%s:%s:00-%s:%s:%s:00' % (repository.getfirst('shopclosedWeek_0'),
	repository.getfirst('shopclosedWeekDay_0'),
	repository.getfirst('shopclosedBegin_0'),
	repository.getfirst('shopclosedWeek_0'),
	repository.getfirst('shopclosedWeekDay_0'),
	repository.getfirst('shopclosedEnd_0')) %>
  </shopclosed>
<%
#
%>


</repository>
<%
redirect('/page/repository.edit/' + fileName + '?referrerGroup='+groupId)
%>
