<%
import time, rfc822
later = time.time() + (60 * 2) # 2 minutes expiry
now = time.time()
req.headers_out['Expires'] = rfc822.formatdate(later)
req.headers_out['Last-modified'] = rfc822.formatdate(now)

domainId = args.domainId
repositoryId = args.repositoryId
repositoryGroupId = args.repositoryGroupId

import os
logDir = req.get_options()['logDir']

#

exists = True
if repositoryId:
  exists = os.path.isfile(req.document_root() + '/' + domainId + '.' + repositoryId + '.repository')
elif repositoryGroupId:
  exists = os.path.isfile(req.document_root() + '/' + domainId + '.' + repositoryGroupId + '.repositoryGroup')

if not exists:
  include('/saharageterror?errorCode=idDoesNotExist')
else:
  type('text/xml; charset=utf-8')
queryArgs = urlencode(dict(domainId=domainId, repositoryGroupId=args.repositoryGroupId, repositoryId=args.repositoryId))
statusUrl = url('%s/getStatus?%s' % (req.get_options()['internalServer'], queryArgs))
req.write(statusUrl.read())
%>
